pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
function _init()
	cls();
	map(0,0);
	framecount=0;
	init_player();
end

function _update()
	framecount+=1;
	reset_player();
	
	--first check collistion and
	--update phyiscal status
	--if we have hpâ™¥,we also update
	--it here.
	local onland=pget(player.x,player.y+8);
	if onland==0 then
		player.y+=player.g;-- +y is down
		player.onland=false;
	else
		player.onland=true;
	end
	
	--then we update the input info
	--currenty, it update play data
	--however, in better implemttation
	--input update speed, then location
	--is updated in previous section.
	if btn(4) then
		if player.onland then
			player.y-=10;
		end
	end
	
		if btn(0) then 
			player.x-=1;
			player.moving=true;
			player.goingleft=true;
		end
		if btn(1) then 
			player.x+=1;
			player.moving=true;
			player.goingleft=false;
		end
end

function _draw()
	cls();
	--after update the status
	--we update the graphics
	_drawmap();
	_drawplayer();
end
-->8
function reset_player()
	player.moving=false;
	--player.goingleft=false;not reset this
	player.onland=true;
end

function init_player()
	player={}
	player.x=24;//pos_x
	player.y=60;//pos_y
	//player.dx;speed_x
	//player.dy;speed_y
	player.g=1;//falling speed
	/////////////
	player.spid=1;
	player.spidm0=2;
	player.spidm1=3;
	player.spidmair=4;
	/////////////
	player.moving=false;
	player.goingleft=false;
	player.onland=true;
	return player;
end
-->8
function _drawmap()
 map(0,0);
end

function _drawplayer()
	local sfc=flr(framecount/2);
	local _spid=player.spid;
	if not player.onland then
		_spid=player.spidmair;
	elseif player.moving then
		if sfc%2==0 then
			_spid=player.spidm0;
		else
			_spid=player.spidm1;
		end
	end
	if player.goingleft then
		_spid+=16;
	end
	spr(_spid,player.x,player.y);
end
__gfx__
000000000088880000888800008888000088880044444444bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000
000000000666666006666660066666600666666044444444bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000
00700700060c0c60060c0c60060c0c60060c0c6044444444bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000
00077000060c0c60060c0c60060c0c60060c0c6044444444bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000
000770000600006006000060060000600600006044444444bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000
007007000666666006666660066666600666666044444444bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000
000000000070070000700770077007000770077044444444bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000
000000000770077007700000000007700000000044444444bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000
00000000008888000088880000888800008888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000066666600666666006666660066666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000006c0c06006c0c06006c0c06006c0c0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000006c0c06006c0c06006c0c06006c0c0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000060000600600006006000060060000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000066666600666666006666660066666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007007000070077007700700077007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077007700770000000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
